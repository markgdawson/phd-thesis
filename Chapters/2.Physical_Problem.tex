\chapter{Physical Problem}
\label{PhysicalProblemChapter}
\lhead{Chapter 2. \emph{Physical Problem}} In this chapter, Maxwell's equations
of classical electrodynamics are introduced, both in integral and differential
forms. The wavelengths of interest are sufficiently large, with respect to
atomic scale variations in the medium, that a macroscopic approach is justified
and quantum mechanical effects are neglected. Constitutive equations will be
introduced for linear, isotropic material both with and without dispersive
effects. Following this, we introduce the Drude model and use it to incorporate
frequency-dependent interactions into Maxwell's equations in a formulation
suitable for efficient numerical calculation. The conditions which must be
satisfied at material interfaces will be derived and alternative forms of
Maxwell's equations discussed.

\section{Maxwell's equations}
The classical theory of electrodynamics decribes the behaviour evolution of
electromagnetic radiation using Maxwell's unification of the equations of
electrodynamics\cite{Balanis:ui,Jackson:490457}. The resulting coupled
equations, which govern the time evolution of electromagnetic waves, are known
collectively as Maxwell's equations, and written in standard units as
\begin{subequations}
  \begin{align}
    \int_{\partial S} \Etilde(\xbftilde,\ttilde) \cdot \vectdl  &= - \frac{d}{dt} \int_{S} \Btilde(\xbftilde,\ttilde) \cdot \vectdS, \label{eq:maxwell-faraday-integral} \\
    \int_{\partial S} \Btilde(\xbftilde,\ttilde) \cdot \vectdl &= \mu_0 \eps_0 \frac{d}{dt} \int_{S} \Etilde(\xbftilde,\ttilde) \cdot \vectdS +  \mu_0 \int_{S} \Jtilde(\xbftilde,\ttilde) \cdot \vectdS, \label{eq:maxwell-ampere-integral} \\
    \int_{\partial \Vol} \Dtilde(\xbftilde,\ttilde)\cdot\vectdS &= \int_\Vol \rho \,\dV, \label{eq:maxwell-gauss-integral} \\
    \int_{\partial \Vol} \Btilde(\xbftilde,\ttilde)\cdot\vectdS &= 0, \label{eq:maxwell-gauss-magnetism-integral}
  \end{align}
\end{subequations}
where $\xbftilde$ is the position vector, $\ttilde$ is time in seconds, $\eps_0$
is the permittivity of free space in farads per meter, $\mu_0$ is the
permeability of free space in henries per meter and the vectors $\Etilde$,
$\Htilde$, $\Dtilde$ and $\Btilde$ are used to denote respectively the electric
field intensity in volts per meter, magnetic field intensity in amps per meter,
electric displacement in coulombs per meter squared, and magnetic induction in
weber per meter squared. $\rho$ denotes volume charge density in coloumb per
meter cubed and $\Jtilde$ denotes electric current density in ampere per meter
squared.
% VIVA: these are BOTH due to EXTERNAL charge only, this means not due to
% induced effects (e.g polarisation) QUOTE: both denote sources due to free
% charges in the system
$\Vol$ denotes any closed volume while the infinitesimal integration elements
$\vectdl$, $\vectdS$ and $\dV$ are respectively a line element, vector surface
element and volume element.
% "In regions where the material parameters are differentiable"... -> but hang
% on! The material parameters are not involved here. What restrictions are the
% for using Stokes' Theorem?
By applying Stokes' Theorem to~\eqref{eq:maxwell-faraday-integral}
and~\eqref{eq:maxwell-ampere-integral} and Gauss' law
to~\eqref{eq:maxwell-gauss-integral}
and~\eqref{eq:maxwell-gauss-magnetism-integral}, the equations in differential
form are obtained as
\begin{subequations}
  \label{eq:maxwells-equations-diff}
  \begin{align}
    \nablatilde \times \Etilde(\xbftilde,\ttilde) + \dpartttilde{\Btilde(\xbftilde, \ttilde)}&= \mathbf{0}, \label{eq:maxwell-faraday} \\
    \nablatilde \times \Htilde(\xbftilde,\ttilde) - \dpartttilde{\Dtilde(\xbftilde, \ttilde)}&= \Jtilde(\xbftilde,\ttilde), \label{eq:maxwell-ampere} \\
    \nablatilde \cdot \Dtilde (\xbftilde,\ttilde) &= \rho(\xbftilde,\ttilde), \label{eq:maxwell-gauss-1}, \\
    \nablatilde \cdot \Btilde (\xbftilde,\ttilde) &= 0, \label{eq:maxwell-gauss-2} .
  \end{align}
\end{subequations}
Where the operator $\nablatilde \times$ and $\nablatilde \cdot$ denote
respectively taking the curl and taking the divergence, both with respect to the
position vector $\xbftilde$. The four equations
in~\eqref{eq:maxwells-equations-diff} are known respectively as Ampere's law
with Maxwell's correction, Faraday's law, Gauss' law and Gauss' law for
magnetism. These are classified as Maxwell's curl
equations,in~\eqref{eq:maxwell-ampere} and~\eqref{eq:maxwell-faraday}, which
determine the evolution of the vector fields in time, and Maxwell's divergence
conditions,in~\eqref{eq:maxwell-gauss-1} and~\eqref{eq:maxwell-gauss-2}, which
are constraints on $\Dtilde$ and $\Btilde$, which should be satisfied at each
point in time.

\subsection{Conservation of charge}
Conservation of charge can be derived directly from Maxwell's equations. The
vector identity
\begin{equation}
  \label{eq:vector-identity-1}
  \nablatilde \cdot ( \nablatilde \times \mathbf{A} (\xbftilde) ) = 0,
\end{equation}
which holds for any vector field $\mathbf{A}$, is substituted into the
expression obtained by taking the divergence of both sides of Ampere's
law,~\eqref{eq:maxwell-ampere}, giving:
$$
- \dpartttilde{( \nablatilde \cdot \Dtilde(\xbftilde,\ttilde) ) } = \nablatilde
\cdot \Jtilde(\xbftilde,\ttilde) .
$$
By substituting Gauss' law,~\eqref{eq:maxwell-gauss-1}, into this equation we
obtain the following conservation equation for charge
\begin{equation}
  \label{eq:maxwell-charge-conservation-2}
  \nablatilde \cdot \Jtilde(\xbftilde,\ttilde) + \dpartttilde{\rho (\xbftilde,\ttilde) } = 0 .
\end{equation}
Taking the divergence of Amperes law,~\eqref{eq:maxwell-ampere}, and removing
the curl term by recalling the identity~\eqref{eq:vector-identity-1}, results in
$$
\nablatilde \cdot \dpartttilde{ \Dtilde(\xbftilde, \ttilde)} = - \nablatilde
\cdot \Jtilde(\xbftilde,\ttilde),
$$
which can be rewritten using the conservation of charge
equation,~\eqref{eq:maxwell-charge-conservation-2}, as
$$
\nablatilde \cdot \dpartttilde{\Dtilde(\xbftilde, \ttilde)} = - \dpartttilde{
  \rho (\xbftilde,\ttilde)}.
$$
Following a similar procedure using~\eqref{eq:maxwell-faraday} results in
$$
\nablatilde \cdot \dpartttilde{ \Btilde(\xbftilde, \ttilde)} = 0
$$

Thus provided the initial conditions satisfy equation Maxwell's divergence
conditions,~\eqref{eq:maxwell-gauss-1} and~\eqref{eq:maxwell-gauss-2}, and the
conservation of charge equation,~\eqref{eq:maxwell-charge-conservation-2}, is
satisfied at all times then if the system is evolved in time using Maxwell's
curl equations alone the divergence conditions will be implicitly satisfied at
all times.

\section{Constitutive equations}
\label{Ch:PhysicalProblem:ConstitutiveEquations}
Maxwell's equations in differential form,~\eqref{eq:maxwells-equations-diff},
are an underdetermined system of equations, with 4 equations and 6 unknowns. The
system of equations is closed by macroscopic constitutive laws, written as
% VIVA: this is not true for materials which exhibit ferromagnetic or
% ferroelectric behaviour - but this is a quantum effect, so outside of our
% classical scope. what are the constitutive laws in this case?
\begin{subequations}
  \begin{align}
    \Dtilde(\xbftilde,\ttilde) &= \eps_0 \Etilde(\xbftilde,\ttilde) + \Ptilde\left[ \Etilde, \Htilde, \xbftilde, \ttilde \right]  \label{eq:constitutive-general-E}\\
    \Btilde(\xbftilde,\ttilde) &= \mu_0 \Htilde(\xbftilde,\ttilde) + \Mtilde\left[ \Etilde, \Htilde, \xbftilde, \ttilde \right] \label{eq:constitutive-general-H}
  \end{align}
\end{subequations}
where $\Ptilde$, the polarisation density, and $\Mtilde$, the magnetisation
density, quantify the change in $\D$ and $\B$ resulting from the interaction
between the applied electromagnetic fields and the medium.
% However, for a given material the dependence may be non-local in space,
% non-local in time, non-linear, and/or anisotropic.
The polarisation and magnetisation densities for linear, isotropic and media
with frequency-independent material properties are described as
\begin{subequations}
  \begin{align}
    \Ptilde &= \ElecSuccept(\xbftilde) \Etilde(\xbftilde,\ttilde), \label{eq:elec-susceptibilities-definition-E} \\
    \Mtilde &= \MagSuccept(\xbftilde) \Htilde(\xbftilde,\ttilde) . \label{eq:elec-susceptibilities-definition-H} 
  \end{align}
\end{subequations}
where $\ElecSuccept$, the electric suceptibility, and $\MagSuccept$, the
electric susceptibility, are a measure of polarisation or magnetisation of the
medium in response and applied fields.
Using~\eqref{eq:elec-susceptibilities-definition-E}
and~\eqref{eq:elec-susceptibilities-definition-H}, the constitutive equations,
shown in~\eqref{eq:constitutive-general-E}
and~\eqref{eq:constitutive-general-H}, can be rewritten in the simple form
\begin{subequations}
  \label{eq:constitutive-linear}
  \begin{align}
    \Dtilde(\xbftilde,\ttilde) = \eps_0 \eps_r(\xbftilde) \Etilde(\xbftilde,\ttilde), \label{eq:constitutive-linear-D} \\
    \Btilde(\xbftilde,\ttilde) = \mu_0 \mu_r(\xbftilde) \Htilde(\xbftilde,\ttilde),\label{eq:constitutive-linear-B}
  \end{align}
\end{subequations}
where the material response is completely characterised by two dimensionless
scalars $ \eps_r, \mu \in \Real$, known respectively as the permittivity and the
relative permeability, given by $\eps_r \equiv 1 + \ElecSuccept $ and $\mu_r
\equiv 1 + \MagSuccept $.
% TODO - cite{Maier:5SXqSjV8} -> copied

\subsection{Dispersive Drude Media}
Most media exhibits frequency dependence of both $\eps_r$ and $\mu_r$, a
phenomena known as dispersion, which arises due to the finite time the medium
needs to repond to changes in applied electromagnetic fields. Whilst dispersive
effects are generally neglected in simulations of dielectrics, many metals of
interest in photonics, such as gold, silver and aluminum, have strongly
frequency dependent relative permittivities in the visible and infra-red regions
of the electromagnetic spectrum\cite{Ordal:1983bg}. This is a consequence of the
finite time required for charged particles in the medium to reach a equilibrium
positions in the presence of a changing applied electromagnetic field. In these
cases, the electric susceptibility can no longer be written as a function of
$\xbftilde$ only, but is expressed as convolution integrals in
time\cite{Jackson:490457}.
% VIVA: article - A comparison of numerical techniques for modeling well
For metals where the effects of interband electron transitions are negligible, a
mechanical model based on the Drude model of solids is
sufficient\cite{taflove2013advances}. For more complex material interactions
however, a more sophisticated model such as the Drude-Lorentz
model\cite{Fox:2001wm,Taflove:1989ds} or approaches based on the
$Z$-transform\cite{sullivan1996z} may be used. We restrict the follow discussion
to media and frequency ranges where magnetisation effects are
frequency-independent, and thus~\eqref{eq:constitutive-linear-B} remains valid,
and where polarisation can be approximated by a single-pole Drude model.

%% *** ## "Polarisation density also describes how a material responds to an
%% applied electric field as well as the way the material changes the electric
%% field, and can be used to calculate the forces that result from those
%% interactions."
% ...based on the kinetic theory of gases,
%
% *** "The induced polarisation due to frequency-dependent electron movement
% leads to a frequency-dependent polarisation (dispersion)" - ref Maier
%
% Electron-ion collisions are random events, with a probability $dt / \tau$ (tau
% is the inv of gamma) - following which the electron velocities are independent
% of velocities prior to collision.
A Drude medium is composed of a lattice of fixed-position, positively charged
ions bound by a delocalised sea of valence band free
electrons\cite{Ashcroft:2005wp,Bandyopadhyay:1503732}. The free electrons,
following the kinetic theory of ideal gases, are non-interacting, independent
particles, described by Newtonian mechanics. In the presence of the electric
field, $\Etilde$, the ions remain fixed and only the free electrons are
displaced from their zero-field equilibrium positions. In the Drude model
polarisation arises from two independent sources: a frequency-independent
background polarisation, $\PtildeInf$, due to the fixed-position charged ions,
and a frequency dependent free electron polarisation, $\PtildeElec$, due to the
delocalisation of free electrons in the presence of an electric field. Thus we
begin by writing~\eqref{eq:constitutive-general-E} in the frequency domain as
\begin{align}
  \hat{\Dtilde}(\xbftilde,\omega) &= \eps_0 \hat{\Etilde}(\xbftilde, \omega) + \PtildeInfFreq + \PtildeElecFreq(\xbftilde,\omega) ,
                                    \label{eq:constitutive_equations_drude_model}
\end{align}
where $\omega$ is the frequency variable and a circumflex denotes the frequency
domain representation of a time domain quantity, such that
$$
\hat{\Box}(\xbftilde,\omega) = \int_{-\infty}^{+\infty} \Box(\xbftilde,\ttilde)
e^{-i \omega t} dt
$$
where the real-valued function $\Box$ of the temporal variable, $\ttilde \in
\Real$, has been written as the complex valued function $\hat{\Box}$ of angular
frequency, $\omega \in \Real$, which is related to frequency, $f$, by $\omega =
2 \pi f$. Note in particular that $- i \omega \hat{\Box}(\xbftilde,\omega) =
\dpartt{ \Box(\xbftilde,\ttilde) }$. Since $\PtildeInfFreq$ is
frequency-independent, following the procedure
from~\autoref{Ch:PhysicalProblem:ConstitutiveEquations}, we
rewrite~\eqref{eq:constitutive_equations_drude_model} as
\begin{equation}
  \hat{\Dtilde}(\xbftilde,\omega) = \eps_0 \eps_{\infty} \hat{\Etilde}(\xbftilde, \omega) + \hat{\Ptilde}_e(\xbftilde,\omega) ,
\end{equation}
where $\eps_{\infty} \equiv 1 + \ElecSucceptInf $ is the permittivity in the
infinite frequency limit, and $\ElecSucceptInf$ is defined by $\PtildeInfFreq
\equiv \eps_0 \ElecSucceptInf \hat{\Etilde} $.
Transforming~\eqref{eq:constitutive_equations_drude_model} directly to the time
domain would lead to a convolution integral, which presents challenges for
numerical simulation\cite{kelley1996piecewise}. We instead follow the so called
Auxiliary Differential Equation (ADE)
approach\cite{Taflove:1989ds,Niegemann:2009uv,Ji:2007dl,okoniewski1997simple,kashiwa1990treatment}.
First we define the current due to free electron polarisation, $\Jtildep$, as
\begin{align}
  \Jtildep(\xbftilde,\ttilde) =  \dpartt{\Ptilde}_e(\xbftilde,\ttilde). \label{eq:polarisation-current-definition}
\end{align}
By multiplying~\eqref{eq:constitutive_equations_drude_model} by $ -i \omega$ and
then transforming it to the time domain, we obtain a constitutive relation in
the form of an ordinary differential equation
\begin{equation}
  \label{eq:constitutive_equations_drude_model_derivative_TD}
  \dodettilde{ \Dtilde (\xbftilde,\ttilde) }= \eps_0 \eps_{\infty} \dodettilde{ \Etilde (\xbftilde, \ttilde) } + \Jtildep(\xbftilde,\ttilde) .
\end{equation}
% TODO - check that the - is correct in this definition, and that J is defined
% in the opposite direction to P
By substitution into Ampere's law,~\eqref{eq:maxwell-ampere}, we obtain the
expression
\begin{align}
  \nablatilde \times \Htilde(\xbftilde,\ttilde) - \dpartttilde{\Dtilde_{\infty}(\xbftilde, \ttilde)} &= \Jtilde(\xbftilde,\ttilde) + \Jtildep(\xbftilde,\ttilde) , \label{eq:drude-ampere}
\end{align}
where, to maintain consistency with dispersion-free form of Maxwell's
equations~\eqref{eq:maxwells-equations-diff} we have defined $\Dtilde_{\infty}
\equiv \eps_0 \eps_{\infty} \Etilde$, as the electric displacement in the
infinite frequency limit.

Motivated by the Drude model, and recalling that that the motion of each
electron is independent, we derive an expression for $\Jtildep$ from the
Newtonion equations of motion of a free electron in the presence of a
time-varying applied field, $\EappliedDrude(\ttilde)$. We note that the
polarisation field due to electron movement is related to the displacemment,
$\xdispelecvect$, of an electron from its zero-field equilibrium position by $
\PtildeElec(\ttilde) = - n q \xdispelecvect(\ttilde) $, where $n$ is the
electron density in the medium. Thus, the Newtonian equations of motion electon
describing the displacement of an electon can be written directly in terms of
polarisation as
\begin{equation}
  \label{eq:equations-of-motion-electron}
  \frac{d^2 \PtildeElec(\ttilde) }{dt^2} + \gamma \frac{d \PtildeElec(\ttilde) }{dt} = - \eps_0 \plasfreq^2 \EappliedDrude(\ttilde),
\end{equation}
where $\gamma$ is a damping coefficient or collision frequency, $m_e$ is the
mass of an electron, $q$ is the charge of an electron, and $\plasfreq \equiv
\sqrt{\frac{n q^2}{m_e \eps_0}}$ is known as the plasma frequency.
% TODO - is it ok to write directly in terms of polarisation (or is this
% ignoring something?) Do I genuinely neglect electron interactions? Another
% approaches I've seen is using a single freuqnecy (monochromatic field
% \Etilde(\xbftilde,\ttilde) = \hat{\mathbf{E_0}} e^{- i \omega \ttilde} TODO -
% what is the plasma frequency physically
From the definition of $\Jtildep$ given
in~\eqref{eq:polarisation-current-definition}, we
~\eqref{eq:polarisation-from-P} can be written as
\begin{equation}
  \dpartttilde{\Jtildep(\xbftilde,\ttilde)} + \gamma \Jtildep(\xbftilde) = \eps_0 \plasfreq^2 \Etilde(\xbftilde,\ttilde).
  \label{eq:pol-current-ADE}
\end{equation}

Maxwell's curl equations and constitutive equations in a Drude dispersive
medium, are given by
\begin{subequations}
  \label{eq:dispersive-maxwell-system}
  \begin{align}
    \nablatilde \times \Etilde(\xbftilde,\ttilde) + \dpartttilde{ \Btilde(\xbftilde, \ttilde)}&= 0, \\
    \nablatilde \times \Htilde(\xbftilde,\ttilde) - \dpartttilde{ \Dtilde_{\infty}(\xbftilde, \ttilde) }&= \Jtilde(\xbftilde,\ttilde) - \Jtildep(\xbftilde,\ttilde), \\
    \Dtilde_{\infty}(\xbftilde,\ttilde) &= \eps_0 \eps_{\infty}(\xbftilde) \Etilde(\xbftilde,\ttilde), \\
    \Btilde(\xbftilde,\ttilde) &= \mu_0 \mu_r(\xbftilde) \Htilde(\xbftilde,\ttilde), \\
    \frac{d \Jtildep(\xbftilde)}{dt} + \gamma \Jtildep(\xbftilde) &= - \eps_0 \plasfreq^2 \Etilde(\xbftilde, \ttilde) . \label{eq:maxwell-dispersive-ADE}
  \end{align}
\end{subequations}
We note that these equations reduce to the non-dispersive case, given
in~\eqref{eq:maxwell-ampere},~\eqref{eq:maxwell-faraday}
and~\eqref{constitutive-linear} in the infinite frequency limit.

Some insight into the behaviour of Drude metals can be obtained by looking at
the relative permittivity obtained in the frequency domain.
First,~\eqref{eq:polarisation-from-P-FD} can be rearranged to obtain the
polarisation due to free electrons in the frequency domain,
\begin{equation}
  \hat{\Ptilde}_e = - \frac{\eps_0 \plasfreq^2}{\omega^2 - i \omega \gamma } \hat{\Etilde}(\omega) .
  \label{eq:polarisation-field-freq-domain}
\end{equation}
Using this expression,~\eqref{eq:constitutive_equations_drude_model} may be
rewritten explicitly in the frequency domain as
\begin{equation}
  \begin{split}
    \hat{\Dtilde}(\xbftilde,\omega) &= \eps_0 \left( \eps_{\infty} - \frac{\plasfreq^2 }{\omega^2 - i \omega \gamma } \right) \hat{\Etilde}(\omega) \\
    &= \eps_0 \hat{\eps}_r (\omega) \hat{\Etilde}(\omega) ,
  \end{split}
\end{equation}
where $\hat{\eps}_r(\omega)$ is the effective permittivity of the metal. Figure
\ref{fig:read-and-imag-effective-permittivity} shows the real and imaginary
parts of $\hat{\eps}_r$, given by
\begin{subequations}
  \begin{align}
    Re\{ \hat{\eps}_r \} &= \eps_{\infty} - \frac{\plasfreq^2}{\omega^2 + \gamma^2}, \\
    Im\{ \hat{\eps}_r \} &= \frac{\gamma \plasfreq}{\omega ( \omega^2 + \gamma^2) } ,
  \end{align}
\end{subequations}
plotted against normalised angular frequency $\omega / \plasfreq$. We observe
that at higher frequencies, due to reduced electron motion, the non-dispersive
dielectric behaviour is recovered as $Re\{\hat{\eps}_r\} \to \eps_{\infty}$ and
$Im\{\hat{\eps}_r\} \to 0$. For frequencies below $\plasfreq$ however, the real
and imaginary parts of the permittivity diverge significantly from the
dispersive values. The positive values of the imaginary part result in an
attenuation of the electric field amplitude in this region.

\begin{figure}[htbp!]
  \begin{center}
    \includegraphics[scale=0.7]{Figures/Chapters/PhysicalProblem/drudePermittivity}
  \end{center}
  \caption{The real (left) and imaginary (right) parts of the dispersive
    frequency domain relative permittivity, $\hat{\eps}_r$, as obtained from
    Drude model.}
  \label{fig:read-and-imag-effective-permittivity}
\end{figure}

\section{Dimensionless form}
% "\eps_0 and \mu_0 introduces an arbitraryness of dimension which we exploit
% for the dimensionless form"
Maxwell's equations are not invariant under change of units, with the constants
$\eps_0$, $\mu_0$ and changing value and position. Unit systems in common use
include the SI units used above, Gaussian units, Lorentz-Heaviside units and
Planck units. In particular, for numerical simulations, dimensionless unit
systems are useful to avoid rounding errors in floating point arithmetic. Maxwell's equations can be obtained in dimensionless form by scaling length and
time by an arbitrary characteristic length, $L$. The following changes of
variable are introduced:
\begin{align}
  \label{eq:dimensionless-scaling-1}
  \xbf &= \frac{\xbftilde}{\charLen}, &  \
                                        t &= \frac{\czero \ttilde}{\charLen}, &  \
                                                                                \plasfreq &= \frac{\plasfreqtilde \charLen}{\czero}, & \
                                                                                                                                       \gamma &= \frac{\gammatilde \charLen}{\czero},
\end{align}
where $\czero = ( \eps_0 \mu_0 )^{-\frac{1}{2}}$ is the speed of light in vacuum
in SI units, and the quantities $\xbf$ and $\t$ have been chosen such that the
dimensionless speed of light in vacuum is unity. Additionally, electromagnetic
field strengths and currents may be scaled by a characteristic field strength,
$\E_0$, by introducing the following dimensionless variables:
\begin{align}
  \label{eq:dimensionless-scaling-2}
  \E &= \Etilde, &  \
                   \H &= \intImpFS \Htilde, &  \
                                              \J &= \charLen \intImpFS \Jtilde, & \
                                                                                  \J_p &= \charLen \intImpFS \Jtilde_p,
\end{align}
% note - could also scale all of these values with E_0
where $\eta_0 = \sqrt{\mu_0 / \eps_0}$ is the intrinsic impedence of free space. Derivatives with respect to $\ttilde$ and $\xbftilde$ are transformed as
\begin{align}
  \label{eq:dimensionless-scaling-3}
  \dpartttilde{\Box} &= \frac{\czero}{\charLen}\dpartt{\Box}, & \
                                                                \dpartxtilde{\Box} &= \frac{1}{\charLen}\dpartx{\Box}
\end{align}
By substitution of~\eqref{eq:dimensionless-scaling-1} and~\eqref{eq:dimensionless-scaling-2} into Maxwell's curl
equations,~\eqref{eq:maxwell-ampere} and~\eqref{eq:maxwell-faraday}, we obtain
the curl equations modified for dispersive materials in dimensionless form:
\begin{subequations}
  \label{eq:dimensionless-maxwell}
  \begin{align}
    \nabla \times \E(\xbf,\t) + \dpartt{\B(\xbf, \t) } &= 0, \\
    \nabla \times \H(\xbf,\t) - \dpartt{ \D_{\infty}(\xbf, \t) } &=  \J_p(\xbf,\t), \\
    \D_{\infty}(\xbf,\t) &= \eps_{\infty}(\xbf) \E(\xbf,\t), \\
    \B(\xbf,\t) &= \mu_r(\xbf) \H(\xbf,\t), \\
    \frac{d \J_p(\xbf,\t)}{d\t} + \gamma \J_p(\xbf,\t) &= \omega_p^2 \E(\xbf,\t),
  \end{align}
\end{subequations}
where $\DInf$ and $\B$ are the appropriately scaled values of $\DtildeInf$ and
$\Btilde$. Note that the non-dispersive form may be recovered in the infinite
frequency limit, where $\J_p = 0$, $\eps_{\infty} = \eps_r$ and $\DInf = \D$
equations,~\eqref{eq:maxwells-equations-diff}, to obtain the equivalent
non-dispersive dimensionless form.

\section{Conservation form}

% *** EVERYTHING WRITTEN AS FREE SPACE - \mu = 1 probably ok for my examples but
% \eps != 1 ***
The dispersive form of Maxwell's equations in dimensionless
form,~\eqref{eq:dimensionless-maxwell}, can be conveniently rewritten as a
linear, hyperbolic conservation law\cite{Godlewski:2013tj,LeVeque:2002vc}
% TODO - Ruben: need to show that system is hyperbolic (and linear?)
\begin{equation}
  \dpartt{ \, \USoltn} + \sum_{k=1}^{nsd} \frac { \partial \, \Flux_k(\USoltn) }{ \partial x_k } = \maxwellSource\,(\USoltn) \: ,
  \label{eq:maxwell-curl-equations-conservation-form}
\end{equation}
where $nsd$ denotes the number of spatial dimensions. The vector of unknowns,
$\USoltn$, the flux vectors, $\Flux_k$, and the source $\maxwellSource$ are
given by
\begin{equation*}
  \begin{array}{c}
    \USoltn =
    \begin{pmatrix}
      \eps_{\infty} E_1, \: \eps_{\infty} E_2 , \: \eps_{\infty} E_3 , \: \mu
      H_1 , \: \mu H_2 , \: \mu H_3 , \: \Jpol_1 , \: \Jpol_2 , \: \Jpol_3
    \end{pmatrix}^T,
    \\
    \Flux_1 =
    \begin{pmatrix}
      0 ,\: H_3 ,\: -H_2 ,\: 0 ,\: -E_3 ,\: E_2 ,\: 0 ,\: 0 ,\: 0
    \end{pmatrix}^T , \\

    \Flux_2 =
    \begin{pmatrix}
      - H_3 ,\: 0 ,\: H_1 ,\: E_3 ,\: 0 ,\: -E_1 ,\: 0 ,\: 0 ,\: 0
    \end{pmatrix}^T , \\

    \Flux_3 =
    \begin{pmatrix}
      H_2 ,\: -H_1 ,\: 0 ,\: -E_2 ,\: E_1 ,\: 0 ,\: 0 ,\: 0 ,\: 0
    \end{pmatrix}^T , \\

    \maxwellSource =
    \begin{pmatrix}
      J_1 + \Jpol_1 ,\: J_2 + \Jpol_2 ,\: J_3 + \Jpol_3 ,\: 0 ,\: 0 ,\: 0 ,\: \omega^2
      \: E_1 - \gamma \Jpol_1 ,\: \omega^2 \: E_2 - \gamma \Jpol_2 ,\: \omega^2 \:
      E_3 - \gamma \Jpol_3
    \end{pmatrix}^T,

  \end{array}
\end{equation*}
where $E_k$, $H_k$ and $\Jpol_k$ are the $k$th spatial components of the
dimensionless intensity vectors of electric field, magnetic field and the
polarisation current, respectively. The material parameters $\eps$, $\mu$,
$\omega$ and $\gamma$ are the electric permittivity, magnetic permeability,
plasma frequency and electron damping coefficient, respectively. The same form
may be used for non-dispersive cases, by setting $\Jpol_k = 0 \; \forall \; k$ and
setting $\eps_{\infty} = \eps_{r}$. The equations can be written in quasilinear
form
\begin{equation}
  \label{eq:quasilinear-form}
  \dpartt{\USoltn}  + \sum_{k=1}^{\nsd}\AQuasiLinear_k\dpart{\xbf_k}{\USoltn} = \AQuasiLinear_s \USoltn
\end{equation}
where

\begin{align}
  \AQuasiLinear_k = 
  \begin{pmatrix}
    \zerov & \RQuasiL_{k} & \zerov \\
    -\RQuasiL_{k} & \zerov & \zerov \\
    \zerov & \zerov & \zerov \\
  \end{pmatrix}
  \: \:
  \textrm{and}\;\;\;
  \AQuasiLinear_s = 
  \begin{pmatrix}
    \zerov  & \zerov & -\IdentityVect\\
    \zerov & \zerov & \zerov \\
    -\plasfreq \IdentityVect & \zerov & - \gamma \IdentityVect \\
  \end{pmatrix}
\end{align}
with
\begin{align}
  \RQuasiL_1 = 
  \begin{pmatrix}
    0 & 0 & 0 \\
    0 & 0 & 1 \\
    0 & -1 & 0 \\
  \end{pmatrix} , \: \: & \RQuasiL_2 =
                          \begin{pmatrix}
                            0 & 0 & -1 \\
                            0 & 0 & 0 \\
                            1 & 0 & 0 \\
                          \end{pmatrix}
      &
        \textrm{and   } \:\:\:
          &
            \RQuasiL_3 = 
            \begin{pmatrix}
              0 & 1 & 0 \\
              -1 & 0 & 0 \\
              0 & 0 & 0 \\
            \end{pmatrix}
      &
\end{align}

A system written in quasilinear form,~\eqref{eq:quasilinear-form}, is said to be hyperbolic if all the eigenvalue of the linear combination $ \AQuasiLinearComb \equiv \sum_{k} a_{k} \AQuasiLinear_k $ are real for any $a_{k} \in \Real$ and the matrix $\AQuasiLinearComb$ is diagonalisable. In $3$-dimensions the matrix $\AQuasiLinearComb$ is given by
$$
  \AQuasiLinearComb =
  \begin{pmatrix}
 & \zerov , & \RTot, & \zerov \\
 & -\RTot & \zerov & \zerov \\
 & \zerov & \zerov & \zerov 
 & \end{pmatrix}
$$
with
$$
  \RTot =
  \begin{pmatrix}
 & 0 & a_3 & -a_2 \\
 & -a_3 & 0 & a_1 \\
& a_2 & -a_1 & 0 
 & \end{pmatrix} .
$$
By writing the characteristic equation,

$$
  \begin{vmatrix}
 & -\lambda \IdentityVect, & \RTot, & \zerov \\
 & -\RTot & -\lambda \IdentityVect & \zerov \\
 & \zerov & \zerov & -\lambda \IdentityVect
 & \end{vmatrix}
= 0
$$
it can be easily shown that the eigenvalues, $\lambda_{i}$, take the values $0$ and $\pm \sqrt{a_1^2 + a_2^2 + a_3^2}$.

% or equivalently as
% $$
% \lambda^5 (a_{1}^2 + a_{2}^2 + a_{3}^2 - \lambda^2)^2 = 0
% 
% $$
% TODO - quasilinear form for TE and TM

\section{Reduction to 2 dimensions}
\subsection{TE and TM modes}
For a physical system where the electric field is translationally invariant in
the $z$-direction, the derivatives with respect to $z$ are zero. Maxwell's
equations are decoupled into two sets of coupled equations with three unknowns
each. The resulting modes in dimensionless form, accounting for dispersion with
the Drude model, are known as the $TE_z$ and $TM_z$ modes.

The $TE_z$ mode is given by

\begin{equation*}
  \begin{array}{ccccc}
    \USoltn_1 = \begin{pmatrix} \eps E_1 \\ \eps E_2 \\ \mu H_3 \\ \JpolScalar_1 \\  \JpolScalar_2 \end{pmatrix} ,
 &
   \Flux_1 = \begin{pmatrix} 0 \\ H_3 \\ E_2 \\ 0 \\  0 \end{pmatrix} ,
 &
   \Flux_2 = \begin{pmatrix} - H_3 \\ 0 \\ -E_1 \\ 0 \\ 0 \end{pmatrix} ,
 &
   \maxwellSource = \begin{pmatrix} J_1 + \JpolScalar_1 \\ J_2+ \JpolScalar_2 \\ 0 \\ \omega^2 \, E_1 - \gamma \JpolScalar_1 \\  \omega^2 \, E_2 - \gamma \JpolScalar_2 \end{pmatrix} ,
  \end{array}
  \:
\end{equation*}

or in quasilinear form,~\eqref{eq:quasilinear-form}, as 
\begin{align*}
  \AQuasiLinear_1 = 
  \begin{pmatrix}
    0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 1 & 0 & 0 \\
    0 & 1 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 \\
  \end{pmatrix}
  \: \:
  \AQuasiLinear_2 = 
  \begin{pmatrix}
    0 & 0 &-1 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 \\
   -1 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 \\
  \end{pmatrix}
  \textrm{and}\;\;\;
  \AQuasiLinear_s = 
  \begin{pmatrix}
    0 & 0 & 0 & \Jnormalised{1} & 0 \\
    0 & 0 & 0 & 0 & \Jnormalised{2} \\
    0 & 0 & 0 & 0 & 0 \\
    \plasfreq^2 & 0 & 0 & -\gamma & 0 \\
    0 & \plasfreq^2 & 0 & 0 & -\gamma \\
  \end{pmatrix}
\end{align*}
where $\Jnormalised{k} = 1 + \frac{J_{k}}{\JpolScalar_{k}}$. The $TE_z$ mode is given by

\begin{equation*}
  \begin{array}{ccccc}
    \USoltn = \begin{pmatrix} \mu H_1 \\ \mu H_2 \\ \eps E_3 \\ \Jpol_3 \end{pmatrix} ,
 &
   \Flux_1 = \begin{pmatrix} 0 \\ -E_3 \\ -H_2 \\ 0 \end{pmatrix} ,
 &
   \Flux_2 = \begin{pmatrix} E_3 \\ 0 \\ H_1 \\ 0 \end{pmatrix} ,
 &
   \maxwellSource = \begin{pmatrix} 0 \\ 0 \\ J_3 + \Jpol_3 \\ \omega^2 \, E_3 - \gamma \Jpol_3 \end{pmatrix} .
  \end{array}
  \:
\end{equation*}
and quasilinear form as
\begin{align*}
  \AQuasiLinear_1 = 
  \begin{pmatrix}
    0 & 0 & 0 & 0 \\
    0 & 0 &-1 & 0 \\
    0 &-1 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
  \end{pmatrix}
  \: \:
  \AQuasiLinear_2 = 
  \begin{pmatrix}
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 0 \\
    1 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
  \end{pmatrix}
  \textrm{and}\;\;\;
  \AQuasiLinear_s = 
  \begin{pmatrix}
    0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
    0 & 0 & 0 & \Jnormalised{3} \\
    0 & 0 & \plasfreq^2 & -\gamma \\
  \end{pmatrix}
\end{align*}

In particular, radiation which is quantised by confinement to a waveguide can be described by the $TE_z$ or $TM_z$ modes.

\section{Interfaces}
% $$
% \mathbf{n} \times \mathbf{E^L} = \mathbf{n} \times \mathbf{E^R} \mathbf{n}
% \times \mathbf{H^L} = \mathbf{n} \times \mathbf{H^R}
% $$
% 
% $$
% \mathbf{n} \cdot ( \eps^L \mathbf{E^L} ) = - \mathbf{n} \cdot ( \eps^R
% \mathbf{E^R} )
% $$
% $$
% \mathbf{n} \cdot ( \mu^L \mathbf{H^L} ) = - \mathbf{n} \cdot ( mu^R
% \mathbf{H^R} )
% $$
%
% TODO - note in Rubens thesis the last equation contains \eps^R\H^R (is this
% correct?)


\subsection{Normal fields}
Consider an interface between two materials, where the material parameters
$\eps$ and $\mu$ change. On the left hand side of the interface we denote the
material parameters as $\eps_L$ and $\mu_L$, and on the right hand side as
$\eps_R$ and $\mu_R$. On the interface, the values of the fields may be
discontinuous, and the differential forms of Maxwell's equations may not be
valid. However interface conditions relating the field values on either side of
the interface, can be derived from the integral form.

Let $E_L$ and $E_R$ be values of the electric field, $E$, in the limit of
approaching the interface from the left or right respectively. Let $S$ be a
cylindrical closed surface, of height $h$, which encloses part of a planar
interface, $I$, where the parallel planes of $S$ are parallel to the interface,
as shown in Figure \ref{fig:material-interface-derivation:E-pillbox}. The
surface of the interface $I$, enclosed by $S$ is denoted as $\Delta I$.
\begin{figure}[htbp!]
  \begin{center}
    \includegraphics[height=0.3\textheight]{Figures/Chapters/PhysicalProblem/interfaceEPillBox}
  \end{center}
  \caption{Schematic showing integration surfaces used to obtain conditions for
    normal fields across an material interface.}
  \label{fig:material-interface-derivation:E-pillbox}
\end{figure}
In the limit $h \to 0$, all electric flux leaves the volume through the parallel
planes of the surface $S$, and~\eqref{eq:maxwell-gauss-integral} can be written
as
$$
\D_L \cdot \hat{\mathbf{n}} \Delta I - \mathbf{D}_R \cdot \hat{\mathbf{n}}
\Delta I = \rho_s \Delta I,
$$
where we have assumed that $S$ is sufficiently small that $D$ is constant. The
material interface condition can be written as
$$
\D_L \cdot \hat{\mathbf{n}} - \mathbf{D}_R \cdot \hat{\mathbf{n}} = \rho_s .
$$
Note that in the case where $\rho_s = 0$, meaning that there are no free
(unbound) charges, then the normal component of the electric flux density, $D$,
is continuous across the interface. By following the analogous procedure for the
magnetic field using~\eqref{eq:maxwell-gauss-magnetism-integral} we obtain
$$
\B_L \cdot \hat{\mathbf{n}} = \B_R \cdot \hat{\mathbf{n}} .
$$
These conditions are used with Maxwell's divergence equations.
% not used in the code!?

\subsection{Tangental fields}

Similarily for the tangental component of electric field we consider a closed
rectangular integration path in the plane of $\E_L$ and $\E_R$ around the same
interface, as shown
in~\eqref{fig:material-interface-derivation:E-rectangular-loop}. Again in the
limit $h \to 0$ and noting that $d\maxwellSource = 0$, we can
write~\eqref{eq:maxwell-faraday-integral} as
\begin{figure}[htbp!]
  \begin{center}
    \includegraphics[height=0.3\textheight]{Figures/Chapters/PhysicalProblem/interfaceContour}
  \end{center}
  \caption{Schematic showing integration contours used to obtain conditions for
    tangental fields across an material interface.}
  \label{fig:material-interface-derivation:E-rectangular-loop}
\end{figure}
\begin{equation}
  \label{eq:material-interfaces-tangentalcondition-E}
  \int_{L_1}^{L_2} \E_L \cdot d\mathbf{l} - \int_{R_1}^{R_2} \E_R \cdot d \mathbf{l} = 0
\end{equation}
or
$$
\E_L \cdot d\mathbf{l} = \E_R \cdot d \mathbf{l} .
$$

The resulting interface condition is therefore that components of $\E$ tangental
to the interface are continuous - which can be written more generally as
$$
\hat{\mathbf{n}} \times \E_L = \hat{\mathbf{n}} \times \E_R .
$$
Again following an analogous procedure for the magnetic field we obtain
$$
\hat{\mathbf{n}} \cdot \H_L = \hat{\mathbf{n}} \times \H_R .
$$
These conditions are used with Maxwell's curl equations.

\subsection{Perfect electric conductors}
Metals with a large number of conduction band electrons can be described by the
perfect electric conductor (PEC) approximation. In a PEC the coulomb repulsion
between electrons causes all free charges to be distributed in an
infinitesimally thin layer on the surface of the material. The distribution of
free charges within a PEC changes instantaneously to counteract any applied
electric fields. Let us consider that the material on the right hand side of the
interface described above is a PEC. In this case, since $E_R$ is zero inside the
material, then~\eqref{eq:material-interfaces-tangentalcondition-E} simply
becomes
$$
\int_{L_1}^{L_2} \E_L \cdot d\mathbf{l} = 0 ,
$$
and the resulting condition is
$$
\E_L \times \hat{\mathbf{n}} = 0 .
$$
Similarily for the magnetic field we obtain
$$
\H_L \times \hat{\mathbf{n}} = \J_s ,
$$
% TODO - what about the other two conditions i.e. divergence conditions - should
% I specify those too?
where $\J_s$ is the surface current.

\subsection{Radiation condition}
Solution of many problems of interest require computation of phenomena occuring
in a physical domain of infinite extent. In such a domain, electromagnetic
sources should scatter energy to infinity. The inverse process, where radiation
transfers energy from infinity to location of the sources is non-physical. To
ensure uniqueness of solutions in an infinite domain, the following condition,
known as the Silver-M\"uller radiation condition, should be satisfied
\begin{align}
  \lim{ r \to \infty } \left( \xbf \times \left( \nabla \times \E \right) + \norm{\xbf} \dpartt{\E} \right) = 0, \\
  \lim{ r \to \infty } \left( \xbf \times \left( \nabla \times \H \right) + \norm{\xbf} \dpartt{\H} \right) = 0.
\end{align}

\section{Relation to wave equation and Helmholtz equation}
\subsection{Wave equation}

Within a homogenous medium, where material parameters are constant and no free
currents or charges are present, Maxwell's equations can be written in wave
equation form, for which plane wave analytical solutions can be
obtained\cite{Jackson:490457}. By combining Faraday's law in SI
form,~\eqref{eq:maxwell-ampere}, with the appropriate constitutive equations for
non-dispersive media,~\eqref{eq:constitutive-linear}, we obtain the expression
\begin{equation}
  \label{eq:wave-equation-derivation-1}
  \nabla \times ( \nabla \times \H ) + \eps_0 \eps_r \dpartt{ \nabla \times \E } = 0 .
\end{equation}
where in the absence of free currents and charges we have used $\J = 0$ and
$\rho = 0$.

Subsituting both the vector identity $ \nabla \times ( \nabla \times \H ) =
\nabla \cdot ( \nabla \cdot \H ) - \nabla^2 \H, $ where we note
from~\eqref{eq:maxwell-gauss-2} that $\nabla \cdot \H = 0$, and Ampere's
law,shown in~\eqref{eq:maxwell-ampere},
into~\eqref{eq:wave-equation-derivation-1} we obtain

\begin{equation}
  \label{eq:maxwell-wave-eqtn-H}
  \nabla^2 \H = \frac{1}{c^2} \ddpartt{ \H },
\end{equation}
which is a wave equation in the unknown $\H$, with the speed of the resultant
wave given by $c_0 = 1/\sqrt{\eps_0 \eps_r \mu_0 \mu_r }$. We note that the
quantities $\eps_0$ and $\mu_0$ are related to the speed of light in vacuum $c_0
= 1/\sqrt{\eps_0 \mu_0 }$. A similar procedure can be followed, starting from
Ampere's law, leading to
\begin{equation}
  \label{eq:maxwell-wave-eqtn-E}
  \nabla^2 \E = \frac{1}{c^2} \ddpartt{ \E } .
\end{equation}
% TODO - Ruben : comments are missing - what are the advantages/limitations of
% this formulation!! Look at LeVeque - why do we use conservation laws in this
% way?

\subsection{Helmholtz equation}
The Helmholtz or reduced wave equation form of~\eqref{eq:maxwell-wave-eqtn-E} is
of particular interest for frequency domain numerical simulations. In this
approach the fields $\E$ and $\H$ are assumed to be time-harmonic, and are
expressed as
\begin{align}
  \label{eq:maxwell-helmholtz-time-harmonic}
  \E(\xbf,t) = \Re \left( \EHelm(\xbf) e^{i \omega t} \right), \\
  \H(\xbf,t) = \Re \left( \HHelm(\xbf) e^{i \omega t} \right),
\end{align}

which, by substitution into the wave equations given
in~\eqref{eq:maxwell-wave-eqtn-E} and~\eqref{eq:maxwell-wave-eqtn-H} we obtain
the Helmholtz equations for electric and magnetic fields
\begin{align}
  \label{eq:helmholtz}
  \nabla^2 \E(\xbf) + k^2 \E(\xbf) = 0, \\
  \nabla^2 \H(\xbf) + k^2 \H(\xbf) = 0,
\end{align}
where $k^2 =\omega^2/c^2$, is known as the propagation constant.

In this form the equations for $\E$ and $\H$ can be solved independently for
each angular frequency, $\omega$. This approached is best suited to problems
with a small number of frequencies of interest, for example a system which is
being driven at a known frequency. By contrast time domain approaches allow
solution for a broad band of frequency responses at once.


% TODO Balanis citation is incomplete P Drude - needs to be removed - maybe the
% solid state one (Optical properties of solids) instead Maybe swap some of the
% references for others (e.g. Fox) Ruben made LOADS of comments on citations Use
% some citations from Rubens paper also


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../Thesis"
%%% End:
